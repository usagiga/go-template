# Generated by github.com/usagiga/editorconfig
# https://github.com/usagiga/editorconfig

name: "update editorconfig"

on:
  schedule:
    - cron: '0 0 1 * *' # Per month

jobs:
  lint:
    name: Bump editorconfig version
    runs-on: ubuntu-latest
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    steps:
      - uses: actions/checkout@v3

      - run: |-
          bash ./.editorconfig.d/scripts/install.sh

          HAS_DIFF=$(git status --short)
          if [[ -z $HAS_DIFF ]]; then
            exit 0
          fi

          # https://api.github.com/users/github-actions%5Bbot%5D
          git config --local user.name "${GITHUB_ACTOR} via github-actions"
          git config --local user.email '41898282+github-actions[bot]@users.noreply.github.com'

          git switch -c "chore/bump-version-editorconfig-$(date '+%Y%m%d')"
          git add '.editorconfig.d'
          git commit -m 'chore: bump version of .editorconfig [skip ci]'
          git push origin HEAD

          gh pr create --fill
